	ORG 0000H
	LJMP INICIO	
	ORG 0100H

INICIO:
	MOV TMOD, #01H
	MOV TH0, #0
	MOV TL0, #0
    SETB TR0
	MOV P1, P2
	JB P2.0, INICIO	
	ACALL COMECANDO

COMECANDO:
	MOV R2, #5
	MOV R3, #5
	MOV R6, #5
	MOV R0, #30H
	MOV R1, #40H
	MOV R7, #3
	JNB P2.0, COMECANDO
	ACALL SEQ_LED
	RET
	
SEQ_LED:
	MOV A, TH0
    XRL A, TL0     
    ANL A, #00000111B
	MOV @R0, A
	INC R0
	MOV B, A
	MOV A, #00000001B
RANDOMIZAR:
	RL A
    DJNZ B, RANDOMIZAR
    CPL A
    MOV P1, A
    MOV R4, #4
    ACALL DELAY
    MOV P1, #11111111B
    MOV R4, #4
    ACALL DELAY
    DJNZ R3, SEQ_LED
    JMP SEQ_JOGADOR
	
SEQ_JOGADOR:
	JNB P2.0, LED_BOTAO_0
    JNB P2.1, LED_BOTAO_1
	JNB P2.2, LED_BOTAO_2
	JNB P2.3, LED_BOTAO_3
	JNB P2.4, LED_BOTAO_4
	JNB P2.5, LED_BOTAO_5
	JNB P2.6, LED_BOTAO_6
	JNB P2.7, LED_BOTAO_7  
	MOV A, R2
	JNZ SEQ_JOGADOR
	JMP PRE_VERIFICAR

DELAY:
	
NEXT:
	MOV R5, #255
AGAIN:
	DJNZ R5, AGAIN
	DJNZ R4, NEXT
	RET

LED_BOTAO_0:
	MOV P1, P2
	JNB P2.0, LED_BOTAO_0
	DEC R2
	MOV A, #0
	MOV @R1, A
	INC R1
	ACALL SEQ_JOGADOR
LED_BOTAO_1:
	MOV P1, P2
	JNB P2.1, LED_BOTAO_1
	DEC R2
	MOV A, #1
	MOV @R1, A
	INC R1
	ACALL SEQ_JOGADOR
LED_BOTAO_2:
	MOV P1, P2
	JNB P2.2, LED_BOTAO_2
	DEC R2
	MOV A, #2
	MOV @R1, A
	INC R1
	ACALL SEQ_JOGADOR
LED_BOTAO_3:
	MOV P1, P2
	JNB P2.3, LED_BOTAO_3
	DEC R2
	MOV A, #3
	MOV @R1, A
	INC R1
	ACALL SEQ_JOGADOR
LED_BOTAO_4:
	MOV P1, P2
	JNB P2.4, LED_BOTAO_4
	DEC R2
	MOV A, #4
	MOV @R1, A
	INC R1
	ACALL SEQ_JOGADOR
LED_BOTAO_5:
	MOV P1, P2
	JNB P2.5, LED_BOTAO_5
	DEC R2
	MOV A, #5
	MOV @R1, A
	INC R1
	ACALL SEQ_JOGADOR
LED_BOTAO_6:
	MOV P1, P2
	JNB P2.6, LED_BOTAO_6
	DEC R2
	MOV A, #6
	MOV @R1, A
	INC R1
	ACALL SEQ_JOGADOR
LED_BOTAO_7:
	MOV P1, P2
	JNB P2.7, LED_BOTAO_7
	DEC R2
	MOV A, #7
	MOV @R1, A
	INC R1
	ACALL SEQ_JOGADOR

PRE_VERIFICAR:
	MOV R0, #30H
	MOV R1, #40H
	JMP VERIFICAR

VERIFICAR:
	MOV A, @R0
	MOV B, @R1
	CJNE A, B, ERROU
	INC R0
	INC R1
	DJNZ R6, VERIFICAR
	JMP ACERTOU

ACERTOU:
	ACALL SERIAL
	MOV A, #'A'
	ACALL LB
	MOV A, #'C'
	ACALL LB
	MOV A, #'E'
	ACALL LB
	MOV A, #'R'
	ACALL LB
	MOV A, #'T'
	ACALL LB
	MOV A, #'O'
	ACALL LB
	MOV A, #'U'
	ACALL LB
	JMP INICIO

ERROU:
	ACALL SERIAL
	MOV A, #'E'
	ACALL LB
	MOV A, #'R'
	ACALL LB
	MOV A, #'R'
	ACALL LB
	MOV A, #'O'
	ACALL LB
	MOV A, #'U'
	ACALL LB
	DEC R7
	MOV A, R7
	JZ GAME_OVER
	JMP RESTART

RESTART:
	MOV R2, #5
	MOV R6, #5
	MOV R1, #40H
	JMP SEQ_JOGADOR

GAME_OVER:
	ACALL SERIAL
	MOV A, #'G'
	ACALL LB
	MOV A, #'A'
	ACALL LB
	MOV A, #'M'
	ACALL LB
	MOV A, #'E'
	ACALL LB
	MOV A, #'O'
	ACALL LB
	MOV A, #'V'
	ACALL LB
	MOV A, #'E'
	ACALL LB
	MOV A, #'R'
	ACALL LB
	SJMP $

SERIAL:
	MOV SCON, #40h 
	MOV PCON, #80h
	MOV TMOD, #20h 
	MOV TH1, #243 
	MOV TL1, #243
	SETB TR1 

LB:
	MOV SBUF, A
LB1:
	JNB TI, LB1
	CLR TI 
	RET
